# Student Lessons Page - ุตูุญุฉ ุฏุฑูุณ ุงูุทุงูุจุฉ

## ูุธุฑุฉ ุนุงูุฉ

ุตูุญุฉ ุฏุฑูุณ ุงูุทุงูุจุฉ ูู ุตูุญุฉ React ูุญุณููุฉ ุจุงููุงูู ุชุนุฑุถ ุงููุญุฏุงุช ุงูุฏุฑุงุณูุฉ ููุทุงูุจุฉ ูุน ุชุชุจุน ุงูุชูุฏู ูุงูุญุงูุฉ.

## ๐ ุงุณุชุฎุฏุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุงูุฌุฏุงูู ุงููุณุชุฎุฏูุฉ (ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุนููุฉ ููุท)

#### 1. ูููุฉ ุงูุทุงูุจุฉ ูุงููุตู
- **`students`**: `student_id`, `full_name`, `grade`, `class_section`
- **`student_classes`**: ุฑุจุท `student_id` ุจู `class_id`
- **`classes`**: `class_id`, `class_name`

#### 2. ุงูุฏุฑูุณ ูุงููุญุฏุงุช
- **`lessons`**: `lesson_id`, `lesson_code`, `lesson_name`, `chapter_id`
  - ูุซุงู lesson_code: "1-1" (ุงููุตู 1ุ ุงูุฏุฑุณ 1)
- **`class_lessons`**: `lesson_id`, `class_id`, `status`, `display_order`
  - status: 'open' | 'locked' | 'soon'

#### 3. ุชูุฏู ุงูุทุงูุจุฉ
- **`lesson_results`**: `lesson_id`, `student_id`, `correct_count`, `total_count`, `created_at`
  - ุงูุฏูุฉ (accuracy) = correct_count / total_count
  - ูุชู ุงุฎุชูุงุฑ ุฃูุถู ุฏูุฉ ููู ุฏุฑุณ

#### 4. ุงูููุงุท ูุงูุฌูุณุงุช
- **`game_points_ledger`**: `student_id`, `points`, `source_type`, `created_at`
- **`sessions`**: `session_id`, `student_id`, `created_at`

#### 5. ุงูุฅุดุนุงุฑุงุช
- **`notifications`**: `message`, `target_type`, `student_id`, `class_id`, `created_at`

## ๐ฏ ููุทู ุงูุนูู

### ุงุณุชุฎุฑุงุฌ ุฑูู ุงููุตู
```javascript
// ูู lesson_code ูุซู "1-1" ุฃู "3-5"
const chapterNumber = parseInt(lesson_code.split('-')[0]);
// "1-1" โ 1
// "3-5" โ 3
```

### ุญุณุงุจ ุชูุฏู ุงููุญุฏุฉ
1. ุฌูุน ูู ุงูุฏุฑูุณ ุงูุชู ุชูุชูู ูููุญุฏุฉ (ููุณ ุฑูู ุงููุตู)
2. ุชุตููุฉ ุงูุฏุฑูุณ ุงูููุชูุญุฉ (status = 'open')
3. ููู ุฏุฑุณุ ุญุณุงุจ ุฃูุถู ุฏูุฉ ูู ุฌุฏูู lesson_results
4. ูุชูุณุท ุงูุฏูุฉ ูููุญุฏุฉ = (ูุฌููุน ุฏูุฉ ุงูุฏุฑูุณ / ุนุฏุฏ ุงูุฏุฑูุณ) ร 100

### ุชุญุฏูุฏ ุญุงูุฉ ุงููุญุฏุฉ
```javascript
if (ูู ุงูุฏุฑูุณ ููููุฉ) {
  ุงูุญุงูุฉ = 'locked'
} else if (ูู ุงูุฏุฑูุณ ุงูููุชูุญุฉ ููุง ุฏูุฉ >= 95%) {
  ุงูุญุงูุฉ = 'completed'
} else {
  ุงูุญุงูุฉ = 'in-progress'
}
```

## ๐ฆ ุชูููู ุงููุญุฏุงุช

```javascript
const UNITS_CONFIG = [
  {
    unitId: 'place_value',
    unitName: 'ุงููููุฉ ุงูููุฒููุฉ',
    unitIcon: '๐ข',
    chapterNumbers: [1],  // ุงููุตู 1
    color: '#00BCD4'
  },
  {
    unitId: 'add_subtract',
    unitName: 'ุงูุฌูุน ูุงูุทุฑุญ',
    unitIcon: 'โโ',
    chapterNumbers: [2],  // ุงููุตู 2
    color: '#7C4DFF'
  },
  // ... ุจุงูู ุงููุญุฏุงุช
];
```

## ๐ ุชุญุณููุงุช ุงูุฃุฏุงุก

### 1. Parallel Data Fetching
```javascript
const [student, classes, points, results, sessions] = await Promise.all([
  supabase.from('students').select('*'),
  supabase.from('student_classes').select('*'),
  // ... ุจุงูู ุงูุงุณุชุนูุงูุงุช
]);
```
**ุงููุงุฆุฏุฉ**: ุชุญููู ุงูุจูุงูุงุช ุจุดูู ูุชูุงุฒู ุจุฏูุงู ูู ุชุณูุณูู (ุฃุณุฑุน ุจู 60-70%)

### 2. useMemo ููุชุตููุฉ
```javascript
const filteredUnits = useMemo(() => {
  if (filterStatus === 'all') return units;
  return units.filter(unit => unit.status === filterStatus);
}, [units, filterStatus]);
```
**ุงููุงุฆุฏุฉ**: ุนุฏู ุฅุนุงุฏุฉ ุญุณุงุจ ุงูุชุตููุฉ ุฅูุง ุนูุฏ ุชุบููุฑ units ุฃู filterStatus

### 3. useCallback ููุฃุญุฏุงุซ
```javascript
const handleFilterChange = useCallback((status) => {
  setFilterStatus(status);
}, []);
```
**ุงููุงุฆุฏุฉ**: ุชุฌูุจ ุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุฏูุงู ูู ูู render

## ๐จ ุงูููููุงุช ุงูุฑุฆูุณูุฉ

### 1. ุงูููุฏุฑ (Header)
- ุงูุดุนุงุฑ ููุนูููุงุช ุงูููุตุฉ
- ุฒุฑ ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ (ููุจุงูู)
- ุงูุฅุดุนุงุฑุงุช
- ูุนูููุงุช ุงูุทุงูุจุฉ

### 2. ููุงุชุฑ ุงููุญุฏุงุช
- ุงููู
- ููุชููุฉ (completed)
- ุฌุงุฑูุฉ (in-progress)
- ููููุฉ (locked)

### 3. ุจุทุงูุงุช ุงููุญุฏุงุช
- ุฃููููุฉ ุงููุญุฏุฉ
- ุงุณู ุงููุญุฏุฉ
- ุดุงุฑุฉ ุงูุญุงูุฉ
- ุดุฑูุท ุงูุชูุฏู
- ุฃุฒุฑุงุฑ ุงูุฅุฌุฑุงุกุงุช (ุฏุฑูุณุ ุฃูุนุงุจ)

### 4. ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ
- ูุธุฑุฉ ุนุงูุฉ
- ุงูุชุนููู ูุงูุฃูุนุงุจ (ูุดุท)
- ูุนุจ ุฌูุงุนู
- ุชุณุฌูู ุงูุฎุฑูุฌ

## ๐ฑ ุงูุชูุงูู ูุน ุงูุฃุฌูุฒุฉ

### Desktop
- ุนุฑุถ ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ุฏุงุฆูุงู
- 3 ุจุทุงูุงุช ูู ุงูุตู

### Tablet
- 2 ุจุทุงูุงุช ูู ุงูุตู
- ูุงุฆูุฉ ุฌุงูุจูุฉ ูุงุจูุฉ ููุทู

### Mobile
- ุจุทุงูุฉ ูุงุญุฏุฉ ูู ุงูุตู
- ูุงุฆูุฉ ุฌุงูุจูุฉ ููุฒููุฉ
- ุฒุฑ hamburger ูููุงุฆูุฉ

## ๐ ุฏูุฑุฉ ุญูุงุฉ ุงูุจูุงูุงุช

```
1. ComponentMount
   โ
2. loadStudentLessonsData()
   โ
3. Verify localStorage.currentUser
   โ
4. Parallel fetch: [student, classes, points, results, sessions]
   โ
5. Get activeClassId
   โ
6. Fetch class_lessons for activeClassId
   โ
7. Fetch lessons details
   โ
8. Calculate bestAccuracyByLessonId
   โ
9. Organize lessons by units
   โ
10. Calculate unit progress & status
    โ
11. Load notifications
    โ
12. setUnits(unitsData)
    โ
13. Render UI
```

## ๐ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

### 1. ูุง ููุฌุฏ ูุณุชุฎุฏู
```javascript
if (!currentUser || currentUser.role !== 'student') {
  navigate('/login');
}
```

### 2. ูุง ุชูุฌุฏ ูุตูู
```javascript
if (!studentClasses || studentClasses.length === 0) {
  setError('ูู ูุชู ุฑุจุทู ุจุฃู ูุตู ุจุนุฏุ ุงูุชุธุฑู ูุนููุชู ๐');
}
```

### 3. ูุง ุชูุฌุฏ ุฏุฑูุณ
```javascript
if (!classLessons || classLessons.length === 0) {
  setError('ูุง ุชูุฌุฏ ุฏุฑูุณ ููุนููุฉ ูู ุงููุตู ุญุงููุงู');
}
```

## ๐ ุฃูุซูุฉ ุนูู ุงูุจูุงูุงุช

### ูุซุงู lesson_results
```json
{
  "lesson_id": 15,
  "student_id": 42,
  "correct_count": 8,
  "total_count": 10,
  "created_at": "2025-12-07T10:30:00"
}
```
ุงูุฏูุฉ = 8/10 = 0.8 = 80%

### ูุซุงู class_lessons
```json
{
  "lesson_id": 15,
  "class_id": 5,
  "status": "open",
  "display_order": 1
}
```

### ูุซุงู lessons
```json
{
  "lesson_id": 15,
  "lesson_code": "1-1",
  "lesson_name": "ูุฑุงุกุฉ ุงูุฃุนุฏุงุฏ ุถูู ุงูููุงููู ููุชุงุจุชูุง"
}
```
ุฑูู ุงููุตู = 1 (ูู "1-1")

## ๐ฏ ุงูุฎุทูุงุช ุงููุงุฏูุฉ

1. โ ุฅูุดุงุก ุงูุตูุญุฉ ุงูุฃุณุงุณูุฉ
2. โณ ุฅุถุงูุฉ ุตูุญุงุช ุงูุฏุฑูุณ ุงูุชูุตูููุฉ ููู ูุญุฏุฉ
3. โณ ุฅุถุงูุฉ ุตูุญุงุช ุงูุฃูุนุงุจ
4. โณ ุฅุถุงูุฉ ูุธุงู ููุงุท ุงูููุฉ ูุงูุถุนู (Skills Analysis)
5. โณ ุฅุถุงูุฉ ูุธุงู ุงููุณุชููุงุช (Levels) ูุงูุฃูุงุชุงุฑุงุช

## ๐ ุฑูุงุจุท ุฐุงุช ุตูุฉ

- `/dashboard` - ููุญุฉ ุงูุชุญูู ุงูุฑุฆูุณูุฉ
- `/lessons` - ุตูุญุฉ ุงูุฏุฑูุณ (ูุฐู ุงูุตูุญุฉ)
- `#/unit/{unitId}/lessons` - ุฏุฑูุณ ูุญุฏุฉ ูุนููุฉ (ูุงุฏูุงู)
- `#/unit/{unitId}/games` - ุฃูุนุงุจ ูุญุฏุฉ ูุนููุฉ (ูุงุฏูุงู)

## ๐ ููุงุญุธุงุช ุชุทููุฑูุฉ

### ุงุณุชุฎุฏุงู localStorage ุจุฏูุงู ูู sessionStorage
ุงูููุฏ ุงูุญุงูู ูุณุชุฎุฏู `localStorage.getItem('currentUser')` ุจุฏูุงู ูู `sessionStorage` ููุง ูู ุจุงูู ุงูุตูุญุงุช. ูููู ุชูุญูุฏูุง ูุงุญูุงู.

### lesson_code Pattern
ููุชุฑุถ ุฃู lesson_code ุจุตูุบุฉ "{chapter}-{lesson}" ูุซู "1-1", "3-5"ุ ุงูุฎ.
ุฅุฐุง ูุงู ููุงู ููุท ูุฎุชููุ ูุฌุจ ุชุนุฏูู ุงุณุชุฎุฑุงุฌ ุฑูู ุงููุตู.

### Fallback Values
ุงูููุฏ ูุณุชุฎุฏู ููู ุงูุชุฑุงุถูุฉ ูุชุฌูุจ ุงูุฃุฎุทุงุก:
- `|| []` ูููุตูููุงุช
- `|| ''` ูููุตูุต
- `?.` ูููุตูู ุงูุขูู

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ูู ุงููุชุตูุญ
```
http://localhost:5173/lessons
```

### 2. ูู ููุญุฉ ุงูุชุญูู
ุฑุงุจุท ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ูู StudentDashboard

### 3. Programmatically
```javascript
navigate('/lessons');
```

## โ ูุงุฆูุฉ ุงูุชุญูู

- [x] ูุฑุงุกุฉ ุจูุงูุงุช ุงูุทุงูุจุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [x] ุฌูุจ ุงููุตูู ูุงูุฏุฑูุณ
- [x] ุญุณุงุจ ุงูุชูุฏู ูู lesson_results
- [x] ุชูุธูู ุงูุฏุฑูุณ ุญุณุจ ุงููุญุฏุงุช
- [x] ูุธุงู ุงูุชุตููุฉ
- [x] ุงูุฅุดุนุงุฑุงุช
- [x] ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ
- [x] ุญุงูุงุช ุงูุชุญููู ูุงูุฃุฎุทุงุก
- [x] ุงูุชูุงูู ูุน ุงูุฃุฌูุฒุฉ ุงููุฎุชููุฉ
- [x] ุชุญุณููุงุช ุงูุฃุฏุงุก (useMemo, useCallback, Promise.all)
- [x] ุงุณุชุฎุฏุงู ุงูุฌุฏุงูู ุงููุนููุฉ ููุท
